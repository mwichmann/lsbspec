<PART ID="tocfhs">
<TITLE>File System Hierarchy</TITLE>

<CHAPTER id=fhs>
<TITLE>FHS</TITLE>
<PARA>
An LSB conforming system must adhere to the FHS 2.2.
</PARA>

<SECT1 id=permissions-must>
<TITLE>Minimal granted Directory and File permissions</TITLE>

<PARA>
In this Chapter "System" means a "LSB compliant system" and                    
"application" means a "LSB compliant (third party vendor) application".        
</PARA>

<PARA>
The system must grant to the application read and execute              
permissions needed to use all system interfaces (ABIs)                 
mentioned in the LSB document and included standards.                  
</PARA>

</SECT1>

<SECT1 id=permissions-should>
<TITLE>Recommendations for applications on ownership and permissions</TITLE>

<SECT2 id=permissions-dirwrite>
<TITLE>Directory Write Permissions</TITLE>

<PARA>
  The application should not depend on having directory write 
  permission outside /tmp, /var/tmp and it's home directory. 
</PARA>

<PARA>
  The application should not depend on owning these directories.
</PARA>

<PARA>
  For these directories the application should be able to work 
  with directory write permissions restricted by the "sticky bit". 
  (Which prevents the application to remove files owned by another 
  user. This is classically done with /tmp, to prevent accidental
  deletion of "foreign" files.)
</PARA>
 
</SECT2>
 
<SECT2 id=permissions-filewrite>
<TITLE>File Write Permissions</TITLE>

<PARA>
     The application should not depend on file write permission on
     files not owned by the user it runs under with the exception 
     of its personal inbox /var/mail/&lt;username&gt;
</PARA>
</SECT2>
         
<SECT2 id=permissions-fileread>
<TITLE>File Read and execute Permissions</TITLE>
 
<PARA>
      The application should not depend on having read permission to
      every file and directory.
</PARA>
 
</SECT2>

<SECT2 id=permissions-sbits>
<TITLE>Suid and Sgid Permissions </TITLE>
 
<PARA>
The application should not depend on suid/sgid permissions on a file
not packaged with the application. Instead, the distribution is
responsible for all system commands having the required permissions
and working correctly.
</PARA>

<PARA>
      Rationale:
  Let us make security officers happy. Lets give them the freedom
  to take sgid/suid perms away, as long as they do not break 
  the systems functionality.
</PARA>
</SECT2>
 
<SECT2 id=priviledged-users>
<TITLE>Privileged users</TITLE>

<PARA>
    "Normal" Applications should not depend on running as a privileged user
</PARA>

<PARA>
    Special applications that have a reason to run under a privileged user,
    should outline these reasons clearly in their documentation, if they
    are not obvious as in the case of a backup/restore program.
    Users of the application should be informed, that "this application 
    demands security privileges, which could infer with system security".
</PARA>

<PARA>
    The application should not contain binary only software which it 
    depends on running as root, as this makes security auditing harder 
    or even impossible. 
</PARA>

</SECT2>

<SECT2 id=changing-permissions>
<TITLE>Changing permissions</TITLE>

<PARA>
    The application should not change permissions of files and 
    directories not being part of their package. To do so without
    a warning notice in the documentation is regarded as unfriendly act.
</PARA>

</SECT2>

<SECT2 id=permission-media>
<TITLE>Removable Media (Cdrom, Floppy,...)</TITLE>
 
<PARA>
     The application should be prepared on removable media being
     mounted with some of the options "noauto", "nouser", "nosuid"
     or "nodev". Also the mount options "uid=X", "gid=X" should be
     awaited with a non-zero uid/gid value X.
</PARA>

<PARA>
     Rationale: 
     System vendors and local system administrators want to run
     applications from removable media, but want the possibility
     to control what the application can do.
</PARA>

<PARA>
     Run-from-removable media applications should not depend on 
     logging in as a privileged user. 
</PARA>
</SECT2>
 
<SECT2 id=permission-installers>
<TITLE>Installable applications</TITLE>

<PARA>
  This paragraph should possibly be part
  of Chapter VII. - Package Format and Installation)
</PARA>

<PARA>
  Installable Applications should not depend on BOTH to run a 
  self-supplied binary install routine with root privileges.
</PARA>
  
</SECT2>
</SECT1>

</CHAPTER>

</PART>
